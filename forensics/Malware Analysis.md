## why perform malware analysis

- determine what exactly happend 
- determine the malicious intent
- identify indicators of compromise 
- find the intruder complexity 
- find the exploited vuln
- identify extend of the damage
- find signatures for ids

---

*Types of Malware Analysis*
==

*Static Analysis*
---

- investigating without running or installing 
- compiling the code to binary results in data loss. this can make the analysis difficult
- examination of binary without executin is manual 
	- extraction of vital data like data strucutres, funcions, call graphs


*Dynamic Malware Analysis*
---

- study the malware behavious by running it in a sandbox
- system baselining - create and capture the testing state
- host integrity monitoring - studying changers 

---

*Preparing Testbed*
==

- Isolated test network to host the testbed and isolated network services like DNS
- target machines installed with variety of OS config and state
- snapshots and re-imaging tools to wipe and rebuild the target machine quickly
- tools for testing
	- imaging tools
	- file/data analysis - for static analysis
	- registry/config tools
	- sandbox - for dynamic analysis
	- log analysers
	- network capture

----

*File Fingerprinting*
--

> getting file hash of the binary to identify and track data across a  network, which can also be used to verify if any changes are made to the binary


*Local and Online Malware Scanning*
--

- scan binary with up-to-date antivirus software
- upload code to virustotal to get analysis


*Performing String Searches*
--

- strings can be commands for doing specific functions 
- analysis can provide information about basic functionality


*Identifying Packing/Obfuscation Methods*
--

- attackers use packing and obfuscation to compress, encrypt or modify malware to avoid detection
- when user executes a packet program. it runs a wrapper to decompress the packed file then run it 
	- this can make analysis process complecated


*Finding the Portable Executables (PE) Information*
---

> PE format is a Windows OS executable file format

- has information about time of creation, import/expoert function, compile time, DLLs , linked files and strings

#### PE format contains the following sections

- `.text` - program code
- `.rdata` - import / export information
- `.data` - global data which system can access from anywhere
- `.rsrc` - resource employed by executable 


---

*Identifying File Dependencies*
---

- use inbuild lib for OS
- Locate these dependencies as they contain information about the run-time requirements of an application
- help to predict what malwhere is intended to do

---

*Malware Disassembly*
--

- disassebaling malwere to its binary format
	- can reveal APIs
	- disassembler - programe that disables code
	- debugger - tool which lets us to debug 


---

*Port Monitoring*
--

if malware want to start a connection it needs to open a port so monitoring port canhelp to detect that

*Registry Monitoring*
--

- Provides persistence storage of critical malware settings and configuration  
- Automatically executes software listed in:  
- Run, RunServices, RunOnce, RunServicesOnce

*Windows Services Monitoring*
--

- malware will try to run as a service in background
- can manipulate registry list

*Startup Programs Monitoring*
---

> Autorun locations ensures malware remains in system after a reboot


Event Logs Monitoring/Analysis
---

- Provides the details of an activity/event on a system
- logs can include
	- system logs
	- security logs 
	- application and service logs
- analysis can be useful


---

- Installation Monitoring
- application monitoring
- file/folder monitoring

these can also help